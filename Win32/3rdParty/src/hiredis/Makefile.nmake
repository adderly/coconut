# WATCH OUT!  This makefile is a work in progress.  It is probably missing
# tons of important things.  DO NOT RELY ON IT TO BUILD A GOOD LIBEVENT.

# Needed for correctness
CFLAGS=/IWIN32-Code /DWIN32 /DHAVE_CONFIG_H /I. /Iinclude /Icompat

# For optimization and warnings
CFLAGS=$(CFLAGS) /Ox /W3 /wd4996 /nologo

# XXXX have a debug mode

LIBFLAGS=/nologo

CORE_OBJS=net.obj hiredis.obj sds.obj async.obj

ALL_OBJS=$(CORE_OBJS)
STATIC_LIBS=libhiredis.lib

all: static_libs tests

static_libs: $(STATIC_LIBS)

libhiredis.lib: $(CORE_OBJS)
	lib $(LIBFLAGS) $(CORE_OBJS) /out:libhiredis.lib 

clean:
	del $(ALL_OBJS)
	del $(STATIC_LIBS)
	cd test
	$(MAKE) /F Makefile.nmake clean

tests:
	cd test
	$(MAKE) /F Makefile.nmake
